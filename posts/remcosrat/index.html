<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>RemcosRATを購入する - DC2INTEL</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta property="og:image" content><meta property="og:title" content="RemcosRATを購入する"><meta property="og:description" content><meta property="og:type" content="article"><meta property="og:url" content="https://intel.dcdcnation.com/posts/remcosrat/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-08-02T19:38:18+09:00"><meta property="article:modified_time" content="2022-08-02T19:38:18+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="RemcosRATを購入する"><meta name=twitter:description content><link href=https://intel.dcdcnation.com/css/fonts.b685ac6f654695232de7b82a9143a46f9e049c8e3af3a21d9737b01f4be211d1.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://intel.dcdcnation.com/css/main.d1574b43a51792a446cd761d6f9b1c9abb39ed2c36ca6984f74aef729eb9f245.css></head><body><div class=content><header><div class=main><a href=https://intel.dcdcnation.com/>DC2INTEL</a></div><nav></nav></header><main><article><div class=title><h1 class=title>RemcosRATを購入する</h1><div class=meta>Posted on Aug 2, 2022</div></div><section class=body><h1 id=はじめに>はじめに</h1><p>こんにちは。DC2INTELの<a href=https://morimolymoly.com>morimolymoly</a>です。<br>今回はRemcosRATを購入した、とあるリサーチャーから情報提供いただきました。
この場を借りて感謝を申し上げます。</p><h1 id=remcosrat概要>RemcosRAT概要</h1><p>RemcosRATはリモート管理ツールのとしてBreakingSecurity社から販売されているRATです。販売会社いわく、正規の目的で使用することが意図されているようですが、AntiAVである<a href=https://breakingsecurity.net/octopus/>Octopus Protector</a>や、侵害後のC2インフラとしての<a href=https://breakingsecurity.net/dns-service/>DNS Service</a>も販売しており、BreakingSecurity社の製品を購入するだけでbotnet構築をすべて賄うことができます。</p><p>そうした中で、RemcosRATはサイバー犯罪に使用されており、<a href=https://www.paloaltonetworks.jp/company/in-the-news/2018/unit42-gorgon-group-slithering-nation-state-cybercrime>APT</a>や、バラマキ型メールによる<a href=https://www.cc.uec.ac.jp/blogs/news/2021/07/20210708agenttesla-remcosrat.html>攻撃</a>、<a href=https://heimdalsecurity.com/blog/remcosrat-malware-is-targeting-african-banks/>銀行への攻撃</a>など、正規のリモートアクセスツールではなく、脅威アクターが使用しているケースをみることがほとんどです。</p><p>そうした中で、匿名を条件にRemcosRAT解析のために実際に購入したとある人物からDC2INTELに情報を提供いただきました。
その情報からRemcosRATの力を紐解いていきます。</p><h1 id=購入方法>購入方法</h1><p>BreakingSecurity社に会員登録し、クレジットカード決済か暗号資産による決済で購入できます。
値段は€58.00で日本円で約8000円です。
情報提供者は暗号資産による決済で購入をしたようでした。</p><h1 id=remcosratのカスタマーサイト>RemcosRATのカスタマーサイト</h1><p>カスタマーサイトでは購入履歴とダウンロード、サポートが提供されています。</p><p><img src=images/order.png alt=購入履歴>
<img src=images/download.png alt=ダウンロード></p><h1 id=remcosratの使い方>RemcosRATの使い方</h1><p>まず、RemcosRATの鍵をkeygenにより生成します。</p><p><img src=images/keygen.png alt=keygen></p><p>次に、builderを用いてRemcosRATをビルドしていきます。</p><p>最初にコネクションの設定を行います。今回は試験目的のためローカルネットを指定しています。
TLSで暗号化することができ、TLSは独自実装になっています。</p><p><img src=images/builder1.png alt=builder1></p><p>次に、インストールを設定します。特権昇格などの機能を有しています。
自身を消すことも設定で可能です。</p><p><img src=images/builder2.png alt=builder2></p><p>次に、RemcosRATの隠蔽設定を行います。プロセスインジェクションなどが設定できます。</p><p><img src=images/builder3.png alt=builder3></p><p>キーロガーも設定可能です。普通のリモートアクセスツールに必要な機能でしょうか……？</p><p><img src=images/builder4.png alt=builder4></p><p>スクリーンのロギングも可能です。</p><p><img src=images/builder5.png alt=builder5></p><p>最後にビルド設定です。パッカーはMPRESSとUPXが使用可能です。</p><p><img src=images/builder6.png alt=builder6></p><p>ビルド結果は以下の通りです。</p><p><img src=images/builder7.png alt=builder7></p><p>管理パネルは以下のようになっています。</p><p><img src=images/panel.png alt=panel></p><h1 id=rat実行結果>RAT実行結果</h1><p><img src=images/rat.png alt=RAT></p><p>RATに感染するとどのような操作も可能になります。
任意のコード実行から、カメラへのアクセス、キーロガー等、“リモートアクセスツール”の本領を発揮できます。</p><h1 id=アンダーグラウンドマーケットでのremcosrat再販>アンダーグラウンド・マーケットでのRemcosRAT再販</h1><p>アンダーグラウンド・マーケットではRemocosRATが再販されていることがあります。
独自のパッカーでパックし、AVやEDR evasionを行い、価値を提供します。</p><p><img src=images/pulseselling.png alt=PulseSelling></p><p>今回はPulseと呼ばれる再販品を入手し、解析を行いました。
まずはBinDiffの結果です。</p><p><img src=images/pulse.png alt=BinDiff></p><p>関数の数からしてパックされていることが容易にわかります。
XPEViewerでも <code>.text</code> セクションがパックされていることがわかります。</p><p><img src=images/xpe.png alt=xpe></p><p>実際にこの検体をアンパックしてみました。</p><p><img src=images/pulseunpack.png alt=unpack></p><p>これのConfigを抽出しました。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Version&#34;</span>: <span style=color:#e6db74>&#34;3.6.0 Pro&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Host:Port:Password&#34;</span>: <span style=color:#e6db74>&#34;74.201.28.143:4782:1&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Assigned name&#34;</span>: <span style=color:#e6db74>&#34;srvhost&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Connect interval&#34;</span>: <span style=color:#e6db74>&#34;1&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Install flag&#34;</span>: <span style=color:#e6db74>&#34;Disable&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Setup HKCU\\Run&#34;</span>: <span style=color:#e6db74>&#34;Enable&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Setup HKLM\\Run&#34;</span>: <span style=color:#e6db74>&#34;Enable&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Install path&#34;</span>: <span style=color:#e6db74>&#34;AppData&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Copy file&#34;</span>: <span style=color:#e6db74>&#34;srvhost.exe&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Startup value&#34;</span>: <span style=color:#e6db74>&#34;srvhost&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Hide file&#34;</span>: <span style=color:#e6db74>&#34;Enable&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Mutex&#34;</span>: <span style=color:#e6db74>&#34;srvhost-8YECU3&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Keylog flag&#34;</span>: <span style=color:#e6db74>&#34;0&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Keylog path&#34;</span>: <span style=color:#e6db74>&#34;Application path&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Keylog file&#34;</span>: <span style=color:#e6db74>&#34;explorer.dat&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Keylog crypt&#34;</span>: <span style=color:#e6db74>&#34;Enable&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Hide keylog file&#34;</span>: <span style=color:#e6db74>&#34;Enable&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Screenshot flag&#34;</span>: <span style=color:#e6db74>&#34;Disable&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Screenshot time&#34;</span>: <span style=color:#e6db74>&#34;10&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Take Screenshot option&#34;</span>: <span style=color:#e6db74>&#34;Disable&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Take screenshot title&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Take screenshot time&#34;</span>: <span style=color:#e6db74>&#34;5&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Screenshot path&#34;</span>: <span style=color:#e6db74>&#34;AppData&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Screenshot file&#34;</span>: <span style=color:#e6db74>&#34;Screenshots&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Screenshot crypt&#34;</span>: <span style=color:#e6db74>&#34;Enable&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Mouse option&#34;</span>: <span style=color:#e6db74>&#34;Disable&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Delete file&#34;</span>: <span style=color:#e6db74>&#34;Disable&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Audio record time&#34;</span>: <span style=color:#e6db74>&#34;5&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Audio path&#34;</span>: <span style=color:#e6db74>&#34;Temp&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Audio folder&#34;</span>: <span style=color:#e6db74>&#34;TestSession&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Connect delay&#34;</span>: <span style=color:#e6db74>&#34;0&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Copy folder&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Keylog folder&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Keylog file max size&#34;</span>: <span style=color:#e6db74>&#34;100000&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>脅威アクターもPro版を使用していることがわかりました。ちなみにこの検体は800人をRATしたと言われているため納得の結果となっております。</p><p>次に、MalwareBazaarで取れた検体とのBinDiff結果を載せます。</p><p><img src=images/real.png alt=MalwareBazaar></p><p>極めて同一のバイナリであると言えます。やはり脅威アクターはRemcosRATのPro版を正規購入もしくはクラックして使用しているようです。</p><h1 id=おわりに>おわりに</h1><p>RemcosRATを購入する、という目を引くタイトルでしたがいかがでしたでしたでしょうか？
実際に購入から使用方法までとあるリサーチャーから提供いただきましたが、これほどの強力なRATとクリプター、C2インフラを販売しているbreaking security社は脅威アクターに使用されていることを承知で行っていることは明らかです。
Ciscoによる<a href=https://gblogs.cisco.com/jp/2018/09/talos-picking-apart-remcos/>記事</a>では同社へのOSINTにより犯罪社が正規の会社の皮を被って商売をしていることを明らかにしています。</p><p>くれぐれも興味本位で購入することは避けましょう。</p><p>また、再販事例など、RemcosRATへ独自パッカーなどの付加価値をつけて販売するケースも存在し、これもまた脅威といえます。</p><h1 id=iocs>IoCs</h1><ul><li>d40fc7bd031e0ea6706bd1a196f7f404fb15df232fac914c7c0263edb12600ba</li><li>1c048a93fc173bacc2388da1042140aeb4d4b34c927e524d3b60946efdab1a16</li></ul></section><div class=post-tags></div></article></main><footer><div style=display:flex></div><div class=footer-info>2022 <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></footer></div></body></html>