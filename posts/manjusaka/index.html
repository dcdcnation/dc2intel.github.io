<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Manjusakaを動かしてみた - DC2INTEL</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta property="og:image" content><meta property="og:title" content="Manjusakaを動かしてみた"><meta property="og:description" content><meta property="og:type" content="article"><meta property="og:url" content="https://intel.dcdcnation.com/posts/manjusaka/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-08-02T19:38:18+09:00"><meta property="article:modified_time" content="2022-08-02T19:38:18+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Manjusakaを動かしてみた"><meta name=twitter:description content><link href=https://intel.dcdcnation.com/css/fonts.b685ac6f654695232de7b82a9143a46f9e049c8e3af3a21d9737b01f4be211d1.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://intel.dcdcnation.com/css/main.d1574b43a51792a446cd761d6f9b1c9abb39ed2c36ca6984f74aef729eb9f245.css></head><body><div class=content><header><div class=main><a href=https://intel.dcdcnation.com/>DC2INTEL</a></div><nav></nav></header><main><article><div class=title><h1 class=title>Manjusakaを動かしてみた</h1><div class=meta>Posted on Aug 2, 2022</div></div><section class=body><h1 id=はじめに>はじめに</h1><p>こんにちは。DC2INTELの<a href=https://morimolymoly.com>morimolymoly</a>です。<br>Manjusakaなる中国発のC2フレー厶ワークをご存知でしょうか？</p><p>Talosのインテリジェンスチームによる<a href=https://blog.talosintelligence.com/2022/08/manjusaka-offensive-framework.html>記事</a>は我々に衝撃を与えました。C2フレー厶ワークは最近乱立しているなかで中国発のものは目を引くものがあります。</p><p>今回は検体が入手できたのでかんたんに動作確認を行いました。</p><h1 id=動作確認>動作確認</h1><p>検体は hxxps://github[.]com/YDHCUI/manjusaka から入手できます。</p><p><img src=images/c2.png alt=C2></p><p>C2サーバを動かすと、ローカルサーバが立ち上がります。</p><p>ローカルサーバに接続するとコントロールパネルが表示されます。</p><p><img src=images/panel.png alt=panel></p><p>英語表記にも対応しています。(ダークモードも)</p><p><img src=images/panel_en.png alt=panel_en></p><p>当該レポジトリから画像を参照いたしますと、このパネルからRust製のインプラントを生成することが可能なようです。</p><p><img src=images/npc.png alt=gen></p><h1 id=インプラント解析>インプラント解析</h1><p>今回はインプラントを入手できましたが、解析は行いませんでした。</p><p><img src=images/ida_res.png alt=ida></p><p>Rust製でほとんどの関数がストリップされています。 別の記事で詳細な解析を行う予定です。</p><h1 id=おわりに>おわりに</h1><p>ただC2を動かすだけの虚無な記事になってしまいました。しかし、インプラントの解析の困難さ、C2のインターフェースの出来の良さには目を見張るものがあります。</p><p>今後DC2INTELはこれを脅威として観測していきたいと思います。</p><h1 id=iocs>IoCs</h1><ul><li>955e9bbcdf1cb230c5f079a08995f510a3b96224545e04c1b1f9889d57dd33c1</li><li>8e9ecd282655f0afbdb6bd562832ae6db108166022eb43ede31c9d7aacbcc0d8</li></ul></section><div class=post-tags></div></article></main><footer><div style=display:flex></div><div class=footer-info>2022 <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></footer></div></body></html>